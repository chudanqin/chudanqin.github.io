<!DOCTYPE html>
<html lang="en">

<!-- layout.ejs-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A website for A-RSnippet Hexo Theme">
    <meta name="author" content="Unnamed">
    <meta name="keyword" content="hexo, hexo theme, A-RSnippet, responsive, bootstrap">
    <link rel="canonical" href="http://yoursite.com/UDID/">
    <link rel="shortcut icon" href="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-person-128.png">
    <link rel="alternate" type="application/atom+xml" title="九指扣将 &lt;a class=&#34;github-button&#34; href=&#34;https://github.com/huyingjie/hexo-theme-A-RSnippet&#34; data-icon=&#34;octicon-star&#34; data-show-count=&#34;true&#34; aria-label=&#34;Star huyingjie/hexo-theme-A-RSnippet on GitHub&#34;&gt;Star&lt;/a&gt;" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <title>
        
        UDID 生成方案｜An A-RSnippet Hexo Theme
        
    </title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <link rel="stylesheet" href="/css/main.css">

    
      <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
      <link rel="stylesheet" href="/css/highlight.css">
    

    
      <script id="dsq-count-scr" src="//hexo-a-rsnippet.disqus.com/count.js" async></script>
    


    
      <meta name="google-site-verification" content="wtCjI-zcpr2FYwWS3sI4OWzMK9e7VomDrZyxpVUUIng" />
    

    

    


    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-38355881-1', 'auto');
    ga('send', 'pageview');
</script>





    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <!-- user customization -->
    <link rel="stylesheet" href="/css/arsnippet.css">
    <script src="/js/arsnippet.css.js"></script>
</head>

<style>
    header.intro-header {
        background-image: url('')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<header>
  <nav class="navbar navbar-default header-navbar" id="nav-top" data-ispost = "true" data-istags="false" data-ishome = "false" >
    <div class="container-fluid">
      <div class="navbar-header page-scroll">
        <button type="button" class="navbar-toggle" data-toggle="collapse" aria-expanded="false"  data-target="#website_navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <span class="navbar-brand animated pulse">
          <a class="brand-logo" href="/">
            九指扣将 <a class="github-button" href="https://github.com/huyingjie/hexo-theme-A-RSnippet" data-icon="octicon-star" data-show-count="true" aria-label="Star huyingjie/hexo-theme-A-RSnippet on GitHub">Star</a>
          </a>
        </span>
      </div>

      <div class="collapse navbar-collapse" id="website_navbar">
          <ul class="nav navbar-nav navbar-right">
              
                <li>
                  <a href="/">home</a>
                </li>
              
                <li>
                  <a href="/tags/">tags</a>
                </li>
              
          </ul>
      </div>
  </nav>


  
    <style>
       .intro-header {
          background-image: url('/img/sky-clouds-moon-horizon.jpg?h=350&amp;auto=compress&amp;cs=tinysrgb');
      }
    </style>

    <div class="intro-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                    <div class="site-heading">
                        <h1>UDID 生成方案</h1>
                        
                        
                          <span class="meta">
                               <span class="meta-item">博主: Unnamed</span>
                               <span class="meta-item">创建于: Jun 15, 2018</span>
                               
                                 <span class="meta-item">更新于: Oct 22, 2018</span>
                               
                          </span>
                          <div class="tags text-center">
                              分类: 
                          </div>
                          <div class="tags text-center">
                              标签: 
                          </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
  
</header>


<!-- Main Content -->
<!-- post.ejs -->
<article>
    <div class="container">
      <div class="col-lg-8 col-lg-offset-1 col-sm-9">
          
            <div class="text-center"><div class="addthis_inline_share_toolbox">
  <script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5272bc2a7b3c1ddc" async = "async" ></script>
</div>
</div><hr>
          
          <div class="subscribe"><a href="http://eepurl.com/dh6iCD" target="_blank">Get Updated for Each Release!</a></div><p>
          <h1 id="iOS-UDID-生成方案"><a href="#iOS-UDID-生成方案" class="headerlink" title="iOS UDID 生成方案"></a>iOS UDID 生成方案</h1><p>UDID，即 Unique Device Identifier，对于一个 App 来说，是一个非常基本却又不可或缺的信息。那为什么要自己再去实现一个呢？</p>
<h2 id="UDID-的历史"><a href="#UDID-的历史" class="headerlink" title="UDID 的历史"></a>UDID 的历史</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 40-bit hexadecimal</span></span><br><span class="line">[[<span class="built_in">UIDevice</span> currentDevice] uniqueIdentifier];</span><br></pre></td></tr></table></figure>
<p>苹果在 iOS 2.0 提供了直接访问 UDID 的接口。在 iOS 5.0 之后，出于保护用户隐私的目的，苹果宣布将废弃该接口（在最新的 SDK 中甚至将其直接移除了）。当然，苹果没有立刻就判了 UDID 的“死刑”，而是给予了一定时间来让开发者过渡。于是，OpenUDID 应运而生。</p>
<h3 id="OpenUDID"><a href="#OpenUDID" class="headerlink" title="OpenUDID"></a><a href="https://github.com/ylechelle/OpenUDID" target="_blank" rel="noopener">OpenUDID</a></h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UUID String</span></span><br><span class="line">[OpenUDID value];</span><br></pre></td></tr></table></figure>
<p>主要使用了 NSUserDefaults 以及 App 级的 Persistent Pasteboard 来做持久化。不过没过多久，OpenUDID 也宣布废弃，并且在 iOS 10.0 中，App 级的 PasteBoard 的持久化被废弃了，OpenUDID 也正式寿终正寝。那还有其他方案来替代 UDID 吗？</p>
<h3 id="MAC"><a href="#MAC" class="headerlink" title="MAC"></a>MAC</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>                 mgmtInfoBase[<span class="number">6</span>];</span><br><span class="line"><span class="keyword">char</span>                *msgBuffer = <span class="literal">NULL</span>;</span><br><span class="line">size_t              length;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span>       macAddress[<span class="number">6</span>];</span><br><span class="line"><span class="keyword">struct</span> if_msghdr    *interfaceMsgStruct;</span><br><span class="line"><span class="keyword">struct</span> sockaddr_dl  *socketStruct;</span><br><span class="line"><span class="built_in">NSString</span>            *errorFlag = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Setup the management Information Base (mib)</span></span><br><span class="line">mgmtInfoBase[<span class="number">0</span>] = <span class="built_in">CTL_NET</span>;        <span class="comment">// Request network subsystem</span></span><br><span class="line">mgmtInfoBase[<span class="number">1</span>] = AF_ROUTE;       <span class="comment">// Routing table info</span></span><br><span class="line">mgmtInfoBase[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">mgmtInfoBase[<span class="number">3</span>] = AF_LINK;        <span class="comment">// Request link layer information</span></span><br><span class="line">mgmtInfoBase[<span class="number">4</span>] = NET_RT_IFLIST;  <span class="comment">// Request all configured interfaces</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// With all configured interfaces requested, get handle index</span></span><br><span class="line"><span class="keyword">if</span> ((mgmtInfoBase[<span class="number">5</span>] = if_nametoindex(<span class="string">"en0"</span>)) == <span class="number">0</span>) &#123;</span><br><span class="line">    errorFlag = <span class="string">@"if_nametoindex failure"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// Get the size of the data available (store in len)</span></span><br><span class="line">    <span class="keyword">if</span> (sysctl(mgmtInfoBase, <span class="number">6</span>, <span class="literal">NULL</span>, &amp;length, <span class="literal">NULL</span>, <span class="number">0</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        errorFlag = <span class="string">@"sysctl mgmtInfoBase failure"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Alloc memory based on above call</span></span><br><span class="line">        <span class="keyword">if</span> ((msgBuffer = malloc(length)) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">            errorFlag = <span class="string">@"buffer allocation failure"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Get system information, store in buffer</span></span><br><span class="line">            <span class="keyword">if</span> (sysctl(mgmtInfoBase, <span class="number">6</span>, msgBuffer, &amp;length, <span class="literal">NULL</span>, <span class="number">0</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                errorFlag = <span class="string">@"sysctl msgBuffer failure"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Befor going any further...</span></span><br><span class="line"><span class="keyword">if</span> (errorFlag != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> errorFlag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Map msgbuffer to interface message structure</span></span><br><span class="line">interfaceMsgStruct = (<span class="keyword">struct</span> if_msghdr *) msgBuffer;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Map to link-level socket structure</span></span><br><span class="line">socketStruct = (<span class="keyword">struct</span> sockaddr_dl *) (interfaceMsgStruct + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Copy link layer address data in socket structure to an array</span></span><br><span class="line">memcpy(&amp;macAddress, socketStruct-&gt;sdl_data + socketStruct-&gt;sdl_nlen, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Read from char array into a string object, into traditional Mac address format</span></span><br><span class="line"><span class="built_in">NSString</span> *macAddressString = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%02X:%02X:%02X:%02X:%02X:%02X"</span>,</span><br><span class="line">                              macAddress[<span class="number">0</span>], macAddress[<span class="number">1</span>], macAddress[<span class="number">2</span>],</span><br><span class="line">                              macAddress[<span class="number">3</span>], macAddress[<span class="number">4</span>], macAddress[<span class="number">5</span>]];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Release the buffer memory</span></span><br><span class="line">free(msgBuffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> macAddressString;</span><br></pre></td></tr></table></figure>
<p>在模拟器上可用，而在真机上，苹果也在 iOS 7.0 后堵住了这个口子，返回了一个常量 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### IMEI / MEID ...</span><br><span class="line"></span><br><span class="line">```objc</span><br><span class="line">extern const NSString * const kCTMobileEquipmentInfoICCID; // SIM 卡号</span><br><span class="line">extern const NSString * const kCTMobileEquipmentInfoIMEI; // 国际移动设备识别码（GSM/WCDMA）</span><br><span class="line">extern const NSString * const kCTMobileEquipmentInfoMEID; // 移动设备识别码（CDMA）</span><br><span class="line">extern const NSString * const kCTMobileEquipmentInfoIMSI; // 移动用户号，存储在 SIM 卡</span><br><span class="line"></span><br><span class="line">typedef struct CTResult &#123;</span><br><span class="line">    int flag;</span><br><span class="line">    int a;</span><br><span class="line">&#125; CTResult;</span><br><span class="line"></span><br><span class="line">typedef const struct __CTServerConnection * CTServerConnectionRef;</span><br><span class="line"></span><br><span class="line">extern CTServerConnectionRef _CTServerConnectionCreate(CFAllocatorRef, int (*)(void *, CFStringRef, CFDictionaryRef, void *), int *);</span><br><span class="line"></span><br><span class="line">#ifdef __arm__</span><br><span class="line">extern void _CTServerConnectionCopyMobileEquipmentInfo(CTResult *status, CTServerConnectionRef connection, CFMutableDictionaryRef *equipmentInfo);</span><br><span class="line">#elif defined __arm64__</span><br><span class="line">extern void _CTServerConnectionCopyMobileEquipmentInfo(CTServerConnectionRef connection, CFMutableDictionaryRef *equipmentInfo, NSInteger *unknown);</span><br><span class="line">#endif</span><br><span class="line">NSString *retVal = nil;</span><br><span class="line">CTServerConnectionRef ctsc = _CTServerConnectionCreate(kCFAllocatorDefault, callback, NULL);</span><br><span class="line">if (ctsc) &#123;</span><br><span class="line">    CFMutableDictionaryRef equipmentInfo = nil;</span><br><span class="line">    #ifdef __arm__</span><br><span class="line">    struct CTResult result;</span><br><span class="line">    _CTServerConnectionCopyMobileEquipmentInfo(&amp;result, ctsc, &amp;equipmentInfo);</span><br><span class="line">    #elif defined __arm64__</span><br><span class="line">    _CTServerConnectionCopyMobileEquipmentInfo(ctsc, &amp;equipmentInfo, NULL);</span><br><span class="line">    #endif</span><br><span class="line">    if (equipmentInfo) &#123;</span><br><span class="line">        CFStringRef value = CFDictionaryGetValue(equipmentInfo, kCTMobileEquipmentInfoIMEI);</span><br><span class="line">        if (value) &#123;</span><br><span class="line">            retVal = [NSString stringWithString:(__bridge id)value];</span><br><span class="line">        &#125;</span><br><span class="line">        CFRelease(equipmentInfo);</span><br><span class="line">    &#125;</span><br><span class="line">    CFRelease(ctsc);</span><br><span class="line">&#125;</span><br><span class="line">return retVal;</span><br></pre></td></tr></table></figure></p>
<p>这两个值都可以在设备的相关信息中找到，可惜是私有 API，而且非越狱设备也无法获取设备信息。（苹果应该是对相关接口设置了权限，只有苹果自己可以获取）</p>
<p>能够替代 UDID 的方案差不多都让苹果给封了，而苹果则推荐用 UUID 来替代 UDID，相应的，在 iOS 6.0 提供了 IDFA 和 IDFV。</p>
<h3 id="IDFA"><a href="#IDFA" class="headerlink" title="IDFA"></a>IDFA</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 8-4-4-4-12 UUID</span></span><br><span class="line">[ASIdentifierManager new].advertisingIdentifier;</span><br></pre></td></tr></table></figure>
<p>广告标识符，和 IDFV 不同的是所有应用获取到的都是同一个值，即设备唯一。不过，重置设备、还原隐私等操作会导致该值重新生成，用户也可设置限制 IDFA 的获取。</p>
<h3 id="IDFV"><a href="#IDFV" class="headerlink" title="IDFV"></a>IDFV</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 8-4-4-4-12 UUID</span></span><br><span class="line">[[<span class="built_in">UIDevice</span> currentDevice] identifierForVendor];</span><br></pre></td></tr></table></figure>
<p>在同一台设备上，来自同一个应用提供商（Vendor）的所有 App 都返回相同的值。</p>
<ul>
<li>对于 iOS 6，Bundle ID 的前两个 Component 被用来生成 Vendor ID；如果 Bundle ID 只有一个 Component，则用其生成 Vendor ID。</li>
<li>对于 iOS 7，除了 Bundle ID 的最后一个 Component，其余部分都用来生成 Vendor ID；如果 Bundle ID 只有一个 Component，则用其生成 Vendor ID。</li>
</ul>
<table>
<thead>
<tr>
<th>Bundle ID</th>
<th>iOS 6.x</th>
<th>iOS 7.x</th>
</tr>
</thead>
<tbody>
<tr>
<td>com.example.app1</td>
<td><strong>com.example</strong>.app1</td>
<td><strong>com.example</strong>.app1</td>
</tr>
<tr>
<td>com.example.app2</td>
<td><strong>com.example</strong>.app2</td>
<td><strong>com.example</strong>.app2</td>
</tr>
<tr>
<td>com.example.app.app1</td>
<td><strong>com.example</strong>.app.app1</td>
<td><strong>com.example.app</strong>.app1</td>
</tr>
<tr>
<td>com.example.app.app2</td>
<td><strong>com.example</strong>.app.app2</td>
<td><strong>com.example.app</strong>.app2</td>
</tr>
<tr>
<td>example</td>
<td><strong>example</strong></td>
<td><strong>example</strong></td>
</tr>
</tbody>
</table>
<p>不过，如果用户删除了应用提供商的所有 App，随后重新安装了这些 App，则 IDFV 的值会改变。此外，如果用 Xcode 安装调试，或者安装 ad-hoc 分发，也会改变这个值。</p>
<h2 id="如何选择"><a href="#如何选择" class="headerlink" title="如何选择"></a>如何选择</h2><ul>
<li>IDFA，设备唯一，用户可以限制 App 获取，也可被用户重置。（iOS 10.0 +，限制后返回空）</li>
<li>IDFV，Vendor 唯一，删除所有相关 App 后重置。</li>
</ul>
<p>权衡之下，两者都有可能被重置掉，IDFA 的最大问题是有可能获取不到，所以 IDFV 是个更好的选择。同时配合 Keychain 的使用，能够最大限度的保证不被重置。</p>
<h2 id="可能-存在的问题："><a href="#可能-存在的问题：" class="headerlink" title="[可能]存在的问题："></a>[可能]存在的问题：</h2><ol>
<li>IDFV 是否在不同设备上冲突，参考 <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier" target="_blank" rel="noopener">UUID</a> 实现，相信冲突的概率非常低。</li>
<li>MD5(groupUDID + BundleID) 冲突，这方面同样没有任何研究，<a href="https://stackoverflow.com/questions/8852668/what-is-the-clash-rate-for-md5" target="_blank" rel="noopener">stackoverflow 是这样说的</a>。</li>
<li><a href="https://forums.developer.apple.com/thread/36442" target="_blank" rel="noopener">Keychain 丢失问题</a>，Keychain 并不保证在 App 删除后仍保留，这是一个实现问题。</li>
</ol>
<p>线上跑了一段时间后，发现了新的问题，用户在新设备上通过 iCloud 备份，从旧设备上恢复，新设备的 UDID 与旧设备的 UDID 相同，排查后发现是保存在 App 本地的文件被同步到 iCloud 上了（暴露了文档读的不够细的问题，缺乏融汇贯通），修改如下：</p>
<ol>
<li>App 本地文件设置不备份到 iCloud。（NSURLIsExcludedFromBackupKey ）</li>
<li>Keychain 不备份到 iCloud。（kSecAttrSynchronizable，默认是关掉的）</li>
<li>Keychain 访问级别设置为 ThisDeviceOnly，防止同步到新设备。（如 kSecAttrAccessibleAfterFirstUnlockThisDeviceOnly）</li>
</ol>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p><a href="https://github.com/fabiocaccamo/FCUUID" target="_blank" rel="noopener">FCUUID</a></p>

          
          <hr>
          <ul class="pager">
              
              <li class="previous">
                  <a href="/ApplePay/" data-toggle="tooltip" data-placement="left"
                     title="ApplePay">&larr; 上一篇</a>
              </li>
              
              
              <li class="next">
                  <a href="/xcodebuild/" data-toggle="tooltip" data-placement="top"
                     title="xcodebuild">下一篇&rarr;</a>
              </li>
              
          </ul>
        
  <br>
  
  <!-- disqus start -->
  <div class="comment">
    <div id="disqus_thread"  class="disqus-thread"></div>
      <script>
      var disqus_shortname = 'hexo-a-rsnippet';
      
      var disqus_url = 'http://yoursite.com/UDID/';
      
      (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  <!-- disqus end -->
  

  
  </div>


        
  <div class="hidden-xs col-sm-3 toc-col">
    <div class="toc-wrap">
        目录
        
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#iOS-UDID-生成方案"><span class="toc-number">1.</span> <span class="toc-text">iOS UDID 生成方案</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#UDID-的历史"><span class="toc-number">1.1.</span> <span class="toc-text">UDID 的历史</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenUDID"><span class="toc-number">1.1.1.</span> <span class="toc-text">OpenUDID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MAC"><span class="toc-number">1.1.2.</span> <span class="toc-text">MAC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDFA"><span class="toc-number">1.1.3.</span> <span class="toc-text">IDFA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDFV"><span class="toc-number">1.1.4.</span> <span class="toc-text">IDFV</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#如何选择"><span class="toc-number">1.2.</span> <span class="toc-text">如何选择</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#可能-存在的问题："><span class="toc-number">1.3.</span> <span class="toc-text">[可能]存在的问题：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他"><span class="toc-number">1.4.</span> <span class="toc-text">其他</span></a></li></ol></li></ol>
        
    </div>
  </div>


      </div>
  </div>
</article>

<!-- Footer -->
<!-- footer.ejs -->
<footer>
    <div class="text-center">
      <ul class="list-inline">
          
          
          

          

          

          
              <li>
                  <a target="_blank"  href="https://github.com/chudanqin">
                      <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                      </span>
                  </a>
              </li>
          

          

          

      </ul>
     <div class="text-muted copyright">
            &copy;
            
            2017 - 2018
            
            
              <i class="fa fa-heart"></i>
            
            Unnamed
        <br>
          
              由 <a target="_blank" href="https://hexo.io">Hexo</a> 强力驱动
          
          
            |
          
          
              主题 - <a href="https://github.com/huyingjie/hexo-theme-A-RSnippet" target="_blank">A-RSnippet</a> v0.1.0
          
          
      </div>
    </div>
</footer>

<!-- Custom Theme JavaScript -->
<script src="/js/main.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>



</body>

</html>
